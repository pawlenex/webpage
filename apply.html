<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Apply to join PawLenx â€” submit your application for open positions.">
  <title>Apply â€” PawLenx</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700;800;900&family=Nunito+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/subpage.css">
  <link rel="stylesheet" href="css/careers.css">
  <link rel="icon" type="image/png" href="static/Happy pets in a circular arrangement.png">
  <!-- jsPDF for client-side PDF generation -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>

  <!-- ========== NAVIGATION ========== -->
  <header class="main-header" id="mainHeader">
    <div class="container">
      <nav class="navbar">
        <a href="index.html" class="logo" aria-label="PawLenx Home">
          <img class="logo-icon" src="static/Happy pets in a circular arrangement.png" alt="PawLenx Logo" width="44" height="44">
          <span class="logo-text">PawLenx</span>
        </a>
        <ul class="nav-links" id="navLinks">
          <li class="nav-item has-dropdown">
            <a href="#" class="nav-link">Our Services <svg class="chevron" width="12" height="12" viewBox="0 0 12 12"><path d="M3 4.5L6 7.5L9 4.5" stroke="currentColor" stroke-width="1.5" fill="none"/></svg></a>
            <div class="dropdown-menu">
              <div class="dropdown-content">
                <div class="dropdown-section">
                  <h4>Companionship</h4>
                  <a href="pet-matching.html">Pet Matching</a>
                  <a href="breed-compatibility.html">Breed Compatibility</a>
                  <a href="family-pet-advisor.html">Family Pet Advisor</a>
                </div>
                <div class="dropdown-section">
                  <h4>Nutrition</h4>
                  <a href="diet-plans.html">Diet Plans</a>
                  <a href="supplement-guide.html">Supplement Guide</a>
                  <a href="allergy-solutions.html">Allergy Solutions</a>
                </div>
                <div class="dropdown-section">
                  <h4>AI Solutions</h4>
                  <a href="health-scanner.html">Health Scanner</a>
                  <a href="behavior-analysis.html">Behavior Analysis</a>
                  <a href="smart-monitoring.html">Smart Monitoring</a>
                </div>
              </div>
            </div>
          </li>
          <li class="nav-item"><a href="index.html#companionship" class="nav-link">Companionship</a></li>
          <li class="nav-item"><a href="index.html#nutrition" class="nav-link">Nutrition</a></li>
          <li class="nav-item"><a href="index.html#ai-section" class="nav-link">Pet AI</a></li>
          <li class="nav-item"><a href="careers.html" class="nav-link active">Careers</a></li>
        </ul>
        <div class="nav-actions">
          <a href="login.html" class="btn btn-text">Log In</a>
          <a href="signup.html" class="btn btn-primary">Sign Up</a>
        </div>
        <button class="mobile-toggle" id="mobileToggle" aria-label="Toggle Navigation">
          <span></span><span></span><span></span>
        </button>
      </nav>
    </div>
  </header>

  <!-- ========== HERO ========== -->
  <section class="subpage-hero" style="min-height: 360px;">
    <div class="subpage-hero-bg">
      <img src="static/A peaceful moment with pets.png" alt="Join the PawLenx team" loading="eager">
    </div>
    <div class="subpage-hero-overlay"></div>
    <div class="container">
      <nav class="breadcrumb">
        <a href="index.html">Home</a>
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
        <a href="careers.html">Careers</a>
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
        <span>Apply</span>
      </nav>
      <h1 class="subpage-title">Apply for: <span class="highlight" id="heroJobTitle">Position</span></h1>
      <p class="subpage-subtitle" id="heroDept">Department</p>
    </div>
  </section>

  <!-- ========== APPLICATION FORM ========== -->
  <section class="subpage-section">
    <div class="container">
      <div class="apply-wrapper">

        <form class="apply-form" id="applicationForm" novalidate>
          <input type="hidden" id="jobTitle" value="">
          <input type="hidden" id="department" value="">

          <!-- Personal Information -->
          <div class="form-section">
            <h3 class="form-section-title">Personal Information</h3>
            <div class="form-row">
              <div class="form-group">
                <label for="firstName">First Name <span class="required">*</span></label>
                <input type="text" id="firstName" name="firstName" required placeholder="John">
              </div>
              <div class="form-group">
                <label for="lastName">Last Name <span class="required">*</span></label>
                <input type="text" id="lastName" name="lastName" required placeholder="Doe">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="email">Email Address <span class="required">*</span></label>
                <input type="email" id="email" name="email" required placeholder="john.doe@email.com">
              </div>
              <div class="form-group">
                <label for="phone">Phone Number <span class="required">*</span></label>
                <input type="tel" id="phone" name="phone" required placeholder="+1 (555) 123-4567">
              </div>
            </div>
            <div class="form-group">
              <label for="location">Current Location <span class="required">*</span></label>
              <input type="text" id="location" name="location" required placeholder="City, State/Country">
            </div>
          </div>

          <!-- Professional Details -->
          <div class="form-section">
            <h3 class="form-section-title">Professional Details</h3>
            <div class="form-row">
              <div class="form-group">
                <label for="currentRole">Current Job Title</label>
                <input type="text" id="currentRole" name="currentRole" placeholder="e.g. Software Engineer">
              </div>
              <div class="form-group">
                <label for="currentCompany">Current Company</label>
                <input type="text" id="currentCompany" name="currentCompany" placeholder="e.g. Tech Corp">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="experience">Years of Experience <span class="required">*</span></label>
                <select id="experience" name="experience" required>
                  <option value="">Select...</option>
                  <option value="0-1">0 â€“ 1 years</option>
                  <option value="1-3">1 â€“ 3 years</option>
                  <option value="3-5">3 â€“ 5 years</option>
                  <option value="5-10">5 â€“ 10 years</option>
                  <option value="10+">10+ years</option>
                </select>
              </div>
              <div class="form-group">
                <label for="startDate">Earliest Start Date <span class="required">*</span></label>
                <input type="date" id="startDate" name="startDate" required>
              </div>
            </div>
            <div class="form-group">
              <label for="linkedin">LinkedIn Profile URL</label>
              <input type="url" id="linkedin" name="linkedin" placeholder="https://linkedin.com/in/yourprofile">
            </div>
            <div class="form-group">
              <label for="portfolio">Portfolio / GitHub URL</label>
              <input type="url" id="portfolio" name="portfolio" required placeholder="https://github.com/yourprofile">
            </div>
          </div>

          <!-- Skills & Qualifications -->
          <div class="form-section">
            <h3 class="form-section-title">Skills & Qualifications</h3>
            <div class="form-group">
              <label for="skills">Key Skills <span class="required">*</span></label>
              <input type="text" id="skills" name="skills" required placeholder="e.g. Python, Machine Learning, React, Docker">
            </div>
            <div class="form-group">
              <label for="education">Highest Education Level <span class="required">*</span></label>
              <select id="education" name="education" required>
                <option value="">Select...</option>
                <option value="High School">High School</option>
                <option value="Associate's Degree">Associate's Degree</option>
                <option value="Bachelor's Degree">Bachelor's Degree</option>
                <option value="Master's Degree">Master's Degree</option>
                <option value="PhD">PhD</option>
                <option value="Other">Other</option>
              </select>
            </div>
          </div>

          <!-- Resume Upload -->
          <div class="form-section">
            <h3 class="form-section-title">Resume / CV</h3>
            <div class="form-group">
              <label for="resume">Upload Your Resume <span class="required">*</span></label>
              <div class="file-upload-area" id="fileUploadArea">
                <input type="file" id="resume" name="resume" accept=".pdf" required class="file-input">
                <div class="file-upload-content">
                  <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#38BDF8" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
                  <p class="file-upload-text">Drag & drop your resume or <span class="file-browse">browse files</span></p>
                  <p class="file-upload-hint">PDF only, max 5MB</p>
                </div>
                <div class="file-selected" style="display:none;">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#10B981" stroke-width="2"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
                  <span class="file-name"></span>
                  <button type="button" class="file-remove">&times;</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Cover Letter / Why PawLenx -->
          <div class="form-section">
            <h3 class="form-section-title">Why PawLenx?</h3>
            <div class="form-group">
              <label for="whyJoin">Why do you want to join PawLenx? <span class="required">*</span></label>
              <textarea id="whyJoin" name="whyJoin" rows="4" required placeholder="Tell us why you're excited about PawLenx and this role..."></textarea>
            </div>
            <div class="form-group">
              <label for="contribution">What unique value would you bring to the team? <span class="required">*</span></label>
              <textarea id="contribution" name="contribution" rows="4" required placeholder="Describe your strengths and how they align with this position..."></textarea>
            </div>
            <div class="form-group">
              <label for="petExperience">Do you have experience with pets? Tell us about it!</label>
              <textarea id="petExperience" name="petExperience" rows="3" placeholder="We love pet people! Share your pet story..."></textarea>
            </div>
          </div>

          <!-- Submit -->
          <div class="form-actions">
            <p class="form-disclaimer">By submitting, your application will be converted to a PDF and uploaded along with your resume to our hiring team. Fields marked <span class="required">*</span> are required.</p>
            <button type="submit" class="btn btn-primary btn-lg" id="submitBtn">
              <span class="btn-text">Submit Application</span>
              <span class="btn-loading" style="display:none;">
                <svg class="spinner" width="20" height="20" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="30 70" stroke-linecap="round"><animateTransform attributeName="transform" type="rotate" dur="1s" from="0 12 12" to="360 12 12" repeatCount="indefinite"/></circle></svg>
                Submitting...
              </span>
            </button>
          </div>
        </form>
      </div>
    </div>
  </section>

  <!-- ========== SUCCESS MODAL ========== -->
  <div class="modal-overlay" id="successModal" style="display:none;">
    <div class="modal-content">
      <div class="modal-icon">ðŸŽ‰</div>
      <h2>Application Submitted!</h2>
      <p>Thank you, <strong id="modalName"></strong>. Your application for <strong id="modalJob"></strong> has been received.</p>
      <p class="modal-sub">A PDF copy of your application has been generated and sent to our hiring team. We'll review it and get back to you within 5 business days.</p>
      <a href="careers.html" class="btn btn-primary">Back to Careers</a>
    </div>
  </div>

  <!-- ========== FOOTER ========== -->
  <footer class="main-footer">
    <div class="container">
      <div class="footer-grid">
        <div class="footer-brand">
          <a href="index.html" class="logo">
            <img class="logo-icon" src="static/Happy pets in a circular arrangement.png" alt="PawLenx Logo" width="40" height="40">
            <span class="logo-text">PawLenx</span>
          </a>
          <p class="footer-desc">AI-powered pet care for the modern pet parent.</p>
        </div>
        <div class="footer-links-group">
          <h4>Services</h4>
          <ul>
            <li><a href="pet-matching.html">Pet Matching</a></li>
            <li><a href="diet-plans.html">Diet Plans</a></li>
            <li><a href="health-scanner.html">AI Health Scanner</a></li>
          </ul>
        </div>
        <div class="footer-links-group">
          <h4>Company</h4>
          <ul>
            <li><a href="index.html#about">About Us</a></li>
            <li><a href="careers.html">Careers</a></li>
            <li><a href="#">Blog</a></li>
          </ul>
        </div>
        <div class="footer-links-group">
          <h4>Support</h4>
          <ul>
            <li><a href="#">Help Center</a></li>
            <li><a href="#">Contact Us</a></li>
            <li><a href="#">Privacy Policy</a></li>
          </ul>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2026 PawLenx, Inc. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script src="js/main.js"></script>
  <script>
    // â”€â”€â”€ Parse URL params for job info â”€â”€â”€
    const params = new URLSearchParams(window.location.search);
    const jobTitle = params.get('job') || 'General Application';
    const department = params.get('dept') || 'Open';

    document.getElementById('heroJobTitle').textContent = jobTitle;
    document.getElementById('heroDept').textContent = department + ' Department';
    document.getElementById('jobTitle').value = jobTitle;
    document.getElementById('department').value = department;
    document.title = `Apply: ${jobTitle} â€” PawLenx`;

    // â”€â”€â”€ Form submission â†’ PDF â†’ Upload â”€â”€â”€
    document.getElementById('applicationForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      // Validate required fields
      const form = e.target;
      if (!form.checkValidity()) {
        form.reportValidity();
        return;
      }

      // Validate resume
      const resumeInput = document.getElementById('resume');
      if (!resumeInput.files || resumeInput.files.length === 0) {
        alert('Please upload your resume (PDF).');
        return;
      }
      const resumeFile = resumeInput.files[0];
      if (resumeFile.size > 5 * 1024 * 1024) {
        alert('Resume file is too large. Maximum size is 5MB.');
        return;
      }

      const submitBtn = document.getElementById('submitBtn');
      const btnText = submitBtn.querySelector('.btn-text');
      const btnLoading = submitBtn.querySelector('.btn-loading');
      submitBtn.disabled = true;
      btnText.style.display = 'none';
      btnLoading.style.display = 'inline-flex';

      try {
        // Gather form data
        const data = {
          jobTitle: document.getElementById('jobTitle').value,
          department: document.getElementById('department').value,
          firstName: document.getElementById('firstName').value.trim(),
          lastName: document.getElementById('lastName').value.trim(),
          email: document.getElementById('email').value.trim(),
          phone: document.getElementById('phone').value.trim(),
          location: document.getElementById('location').value.trim(),
          currentRole: document.getElementById('currentRole').value.trim(),
          currentCompany: document.getElementById('currentCompany').value.trim(),
          experience: document.getElementById('experience').value,
          startDate: document.getElementById('startDate').value,
          linkedin: document.getElementById('linkedin').value.trim(),
          portfolio: document.getElementById('portfolio').value.trim(),
          skills: document.getElementById('skills').value.trim(),
          education: document.getElementById('education').value,
          whyJoin: document.getElementById('whyJoin').value.trim(),
          contribution: document.getElementById('contribution').value.trim(),
          petExperience: document.getElementById('petExperience').value.trim(),
        };

        // â”€â”€â”€ Generate Beautiful PDF with jsPDF â”€â”€â”€
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();

        const pageWidth = doc.internal.pageSize.getWidth();
        const pageHeight = doc.internal.pageSize.getHeight();
        const margin = 18;
        const contentWidth = pageWidth - margin * 2;
        let y = 0;

        // --- Color palette ---
        const brandBlue = [56, 189, 248];
        const brandDark = [15, 23, 42];
        const lightGray = [241, 245, 249];
        const medGray = [148, 163, 184];
        const textDark = [30, 41, 59];
        const textMed = [71, 85, 105];
        const white = [255, 255, 255];
        const accentGreen = [16, 185, 129];

        // Helper: wrapped text with page break
        function addWrapped(text, x, startY, maxW, lh, font, size, color) {
          doc.setFont('helvetica', font || 'normal');
          doc.setFontSize(size || 10);
          doc.setTextColor(...(color || textDark));
          const lines = doc.splitTextToSize(text || '', maxW);
          lines.forEach(line => {
            if (startY > pageHeight - 25) {
              addFooter();
              doc.addPage();
              startY = 25;
            }
            doc.text(line, x, startY);
            startY += (lh || 5);
          });
          return startY;
        }

        // Helper: section header with colored left bar
        function sectionHeader(title, yPos) {
          if (yPos > pageHeight - 50) {
            addFooter();
            doc.addPage();
            yPos = 25;
          }
          doc.setFillColor(...brandBlue);
          doc.roundedRect(margin, yPos - 5, 3, 14, 1.5, 1.5, 'F');
          doc.setFont('helvetica', 'bold');
          doc.setFontSize(13);
          doc.setTextColor(...brandDark);
          doc.text(title, margin + 8, yPos + 5);
          return yPos + 16;
        }

        // Helper: label-value pair
        function labelValue(label, value, x, yPos) {
          if (!value) return yPos;
          if (yPos > pageHeight - 20) {
            addFooter();
            doc.addPage();
            yPos = 25;
          }
          doc.setFont('helvetica', 'bold');
          doc.setFontSize(9);
          doc.setTextColor(...medGray);
          doc.text(label.toUpperCase(), x, yPos);
          doc.setFont('helvetica', 'normal');
          doc.setFontSize(10.5);
          doc.setTextColor(...textDark);
          doc.text(value, x, yPos + 5.5);
          return yPos + 14;
        }

        // Helper: footer on each page
        function addFooter() {
          const pNum = doc.internal.getNumberOfPages();
          doc.setPage(pNum);
          doc.setDrawColor(...lightGray);
          doc.line(margin, pageHeight - 15, pageWidth - margin, pageHeight - 15);
          doc.setFontSize(7);
          doc.setTextColor(...medGray);
          doc.text('PawLenx Careers Portal', margin, pageHeight - 10);
          doc.text('Confidential', pageWidth / 2, pageHeight - 10, { align: 'center' });
          doc.text('Page ' + pNum, pageWidth - margin, pageHeight - 10, { align: 'right' });
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â• PAGE 1 â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        // --- Top header bar ---
        doc.setFillColor(...brandBlue);
        doc.rect(0, 0, pageWidth, 52, 'F');

        // Small decorative accent
        doc.setFillColor(14, 165, 233); // slightly darker blue
        doc.rect(0, 48, pageWidth, 4, 'F');

        // Brand name
        doc.setTextColor(...white);
        doc.setFont('helvetica', 'bold');
        doc.setFontSize(24);
        doc.text('PawLenx', margin, 22);

        // Subtitle
        doc.setFont('helvetica', 'normal');
        doc.setFontSize(10);
        doc.setTextColor(219, 234, 254); // light blue
        doc.text('Job Application', margin, 32);

        // Date - right aligned
        doc.setFontSize(9);
        doc.setTextColor(...white);
        const dateStr = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
        doc.text(dateStr, pageWidth - margin, 22, { align: 'right' });

        // Application ID
        doc.setFontSize(8);
        doc.setTextColor(219, 234, 254);
        const appId = 'APP-' + Date.now().toString(36).toUpperCase();
        doc.text('Ref: ' + appId, pageWidth - margin, 30, { align: 'right' });

        // --- Applicant name banner ---
        y = 62;
        doc.setFillColor(...lightGray);
        doc.roundedRect(margin, y - 4, contentWidth, 22, 3, 3, 'F');
        doc.setFont('helvetica', 'bold');
        doc.setFontSize(16);
        doc.setTextColor(...brandDark);
        doc.text(data.firstName + ' ' + data.lastName, margin + 8, y + 8);
        doc.setFont('helvetica', 'normal');
        doc.setFontSize(10);
        doc.setTextColor(...textMed);
        doc.text(data.jobTitle + '  |  ' + data.department, margin + 8, y + 15);
        y += 30;

        // --- Contact info row ---
        const contactItems = [
          { icon: '\u2709', val: data.email },
          { icon: '\u260E', val: data.phone },
          { icon: '\u25CB', val: data.location }
        ];
        doc.setFontSize(9);
        doc.setTextColor(...textMed);
        let cx = margin;
        contactItems.forEach(item => {
          if (item.val) {
            doc.setFont('helvetica', 'normal');
            doc.text(item.icon + '  ' + item.val, cx, y);
            cx += doc.getTextWidth(item.icon + '  ' + item.val) + 12;
          }
        });
        y += 12;

        // --- Thin divider ---
        doc.setDrawColor(226, 232, 240);
        doc.setLineWidth(0.3);
        doc.line(margin, y, pageWidth - margin, y);
        y += 10;

        // â”€â”€ Professional Details section â”€â”€
        y = sectionHeader('Professional Details', y);

        const col1x = margin + 8;
        const col2x = pageWidth / 2 + 5;
        let leftY = y;
        let rightY = y;

        leftY = labelValue('Current Role', data.currentRole || 'N/A', col1x, leftY);
        rightY = labelValue('Company', data.currentCompany || 'N/A', col2x, rightY);
        leftY = labelValue('Experience', data.experience + ' years', col1x, leftY);
        rightY = labelValue('Education', data.education, col2x, rightY);
        leftY = labelValue('Available From', data.startDate, col1x, leftY);
        rightY = labelValue('LinkedIn', data.linkedin || 'N/A', col2x, rightY);

        y = Math.max(leftY, rightY) + 4;

        if (data.portfolio) {
          y = labelValue('Portfolio / GitHub', data.portfolio, col1x, y);
        }
        y += 2;

        // â”€â”€ Skills section â”€â”€
        y = sectionHeader('Skills & Expertise', y);
        const skillsList = data.skills.split(',').map(s => s.trim()).filter(Boolean);
        let sx = margin + 8;
        let sy = y;
        skillsList.forEach(skill => {
          const tw = doc.getTextWidth(skill) + 10;
          if (sx + tw > pageWidth - margin) {
            sx = margin + 8;
            sy += 9;
          }
          // Skill pill
          doc.setFillColor(224, 242, 254); // blue-100
          doc.roundedRect(sx - 3, sy - 5, tw, 8, 3, 3, 'F');
          doc.setFont('helvetica', 'normal');
          doc.setFontSize(9);
          doc.setTextColor(2, 132, 199); // blue-600
          doc.text(skill, sx, sy);
          sx += tw + 4;
        });
        y = sy + 14;

        // --- Divider ---
        doc.setDrawColor(226, 232, 240);
        doc.setLineWidth(0.3);
        doc.line(margin, y, pageWidth - margin, y);
        y += 10;

        // â”€â”€ Why PawLenx â”€â”€
        y = sectionHeader('Why PawLenx?', y);
        y = addWrapped(data.whyJoin, margin + 8, y, contentWidth - 12, 5.5, 'normal', 10, textDark);
        y += 8;

        // â”€â”€ Contribution â”€â”€
        y = sectionHeader('Unique Value & Contribution', y);
        y = addWrapped(data.contribution, margin + 8, y, contentWidth - 12, 5.5, 'normal', 10, textDark);
        y += 8;

        // â”€â”€ Pet Experience (optional) â”€â”€
        if (data.petExperience) {
          y = sectionHeader('Pet Experience', y);
          // Green accent box
          doc.setFillColor(236, 253, 245); // green-50
          const petLines = doc.splitTextToSize(data.petExperience, contentWidth - 20);
          const boxH = petLines.length * 5.5 + 10;
          if (y + boxH > pageHeight - 25) { addFooter(); doc.addPage(); y = 25; }
          doc.roundedRect(margin + 4, y - 4, contentWidth - 8, boxH, 3, 3, 'F');
          doc.setFillColor(...accentGreen);
          doc.roundedRect(margin + 4, y - 4, 2.5, boxH, 1.5, 1.5, 'F');
          y = addWrapped(data.petExperience, margin + 12, y + 2, contentWidth - 20, 5.5, 'normal', 10, textDark);
          y += 8;
        }

        // â”€â”€ Resume note â”€â”€
        if (y > pageHeight - 35) { addFooter(); doc.addPage(); y = 25; }
        doc.setFillColor(254, 243, 199); // amber-100
        doc.roundedRect(margin, y - 2, contentWidth, 14, 3, 3, 'F');
        doc.setFont('helvetica', 'bold');
        doc.setFontSize(9);
        doc.setTextColor(146, 64, 14); // amber-800
        doc.text('\u26A0  Resume attached separately in applicant folder.', margin + 6, y + 7);
        y += 20;

        // Add footer to all pages
        const totalPages = doc.internal.getNumberOfPages();
        for (let p = 1; p <= totalPages; p++) {
          doc.setPage(p);
          addFooter();
        }

        // Convert PDF to blob
        const pdfFileName = `${data.firstName}_${data.lastName}_Application.pdf`;
        const pdfBlob = doc.output('blob');

        // â”€â”€â”€ Upload both PDF + Resume to backend â”€â”€â”€
        const formData = new FormData();
        formData.append('application', pdfBlob, pdfFileName);
        formData.append('resume', resumeFile, resumeFile.name);
        formData.append('applicantName', `${data.firstName} ${data.lastName}`);
        formData.append('jobTitle', data.jobTitle);
        formData.append('email', data.email);

        const response = await fetch('https://webpage-1-pzkj.onrender.com/api/applications/submit', {
          method: 'POST',
          body: formData,
        });

        if (!response.ok) {
          throw new Error(`Server error: ${response.status}`);
        }

        const result = await response.json();
        console.log('Application submitted:', result);

        // Show success modal
        document.getElementById('modalName').textContent = `${data.firstName} ${data.lastName}`;
        document.getElementById('modalJob').textContent = data.jobTitle;
        document.getElementById('successModal').style.display = 'flex';

      } catch (err) {
        console.error('Submission error:', err);
        alert('There was an error submitting your application. Please try again.');
      } finally {
        submitBtn.disabled = false;
        btnText.style.display = 'inline';
        btnLoading.style.display = 'none';
      }
    });

    // â”€â”€â”€ Resume file upload UI â”€â”€â”€
    const fileInput = document.getElementById('resume');
    const uploadArea = document.getElementById('fileUploadArea');
    const uploadContent = uploadArea.querySelector('.file-upload-content');
    const fileSelected = uploadArea.querySelector('.file-selected');
    const fileNameSpan = uploadArea.querySelector('.file-name');
    const fileRemoveBtn = uploadArea.querySelector('.file-remove');

    fileInput.addEventListener('change', () => {
      if (fileInput.files.length > 0) {
        const f = fileInput.files[0];
        if (f.type !== 'application/pdf') {
          alert('Please upload a PDF file.');
          fileInput.value = '';
          return;
        }
        if (f.size > 5 * 1024 * 1024) {
          alert('File too large. Max 5MB.');
          fileInput.value = '';
          return;
        }
        fileNameSpan.textContent = f.name + ' (' + (f.size / 1024).toFixed(0) + ' KB)';
        uploadContent.style.display = 'none';
        fileSelected.style.display = 'flex';
      }
    });

    fileRemoveBtn.addEventListener('click', () => {
      fileInput.value = '';
      uploadContent.style.display = 'flex';
      fileSelected.style.display = 'none';
    });

    // Drag and drop
    uploadArea.addEventListener('dragover', (e) => { e.preventDefault(); uploadArea.classList.add('drag-over'); });
    uploadArea.addEventListener('dragleave', () => { uploadArea.classList.remove('drag-over'); });
    uploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadArea.classList.remove('drag-over');
      if (e.dataTransfer.files.length) {
        fileInput.files = e.dataTransfer.files;
        fileInput.dispatchEvent(new Event('change'));
      }
    });
  </script>
</body>
</html>
